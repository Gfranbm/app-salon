{"version":3,"sources":["app.js"],"names":["pagina","cita","nombre","fecha","hora","servicios","iniciarApp","mostrarServicios","mostrarSeccion","seccionAnterior","document","querySelector","classList","remove","add","tabAnteior","cambiarSeccion","querySelectorAll","forEach","enlace","addEventListener","e","parseInt","target","dataset","paso","botonesPaginador","async","url","resultado","fetch","json","servicio","id","precio","nombreServicio","createElement","textContent","precioServicio","servicioDiv","idServicio","onclick","selecionarServicio","appendChild","error","console","log","elemento","tagName","parentElement","contains","eliminarServicio","agregarServicio","firstElementChild","nextElementSibling","filter","servicioObj","paginaSiguiente","paginaAnterior","mostrarResumen","resumenDiv","firstChild","removeChild","Object","values","includes","noServicios","headingCita","nombreCita","innerHTML","fechaCita","horaCita","serviciosCita","headingServicios","cantidad","contenedorServicio","textoServicio","totalServicio","split","trim","cantidadPagar","nombreTexto","value","length","mostrarAlerta","alerta","mensaje","tipo","setTimeout","fechaInput","dia","Date","getUTCDay","preventDefault","deshabilitarFechaAnterior","fechaAhora","year","getFullYear","mes","getMonth","getDate","fechaDeshabilitar","min","inputHora"],"mappings":"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","file":"bundle.js","sourcesContent":["let pagina = 1;\nconst cita ={\n    nombre: '',\n    fecha: '',\n    hora: '',\n    servicios:[]\n}\ndocument.addEventListener('DOMContentLoaded', function(){\n    iniciarApp();\n\n    //restalta el div actual\n    mostrarSeccion();\n    //oculta o muestra la seccion\n    cambiarSeccion();\n\n    //paginacion\n    paginaSiguiente();\n\n    paginaAnterior();\n\n    //comprueba la pagina actual paraocultar la paginacion\n    botonesPaginador();\n\n    //muestra el resumen o el error en caso no tener informacion\n    mostrarResumen();\n\n    //almacena el nombre del acita en el objeto\n    nombreCita();\n\n    //almacena la fecha de la cita en el ojeto\n    fechaCita();\n    \n    //deshabilita fechas anteriores\n    deshabilitarFechaAnterior();\n\n    //almancena la hora en el objeto\n    horaCita();\n\n\n});\n\n\n\n// termina  \n\n\n\nfunction iniciarApp(){\n    mostrarServicios();\n}\n\nfunction mostrarSeccion(){\n   //eleminar secccion\n   seccionAnterior = document.querySelector('.mostrar-seccion');\n   if(seccionAnterior){  \n       seccionAnterior.classList.remove('mostrar-seccion');\n   } \n\n    const seccionActual = document.querySelector(`#paso-${pagina}`);\n    seccionActual.classList.add('mostrar-seccion');\n\n    //Eliminar la clase de actuall en el tab anteior\n    const tabAnteior = document.querySelector('.tabs .actual');\n    if(tabAnteior){\n        tabAnteior.classList.remove('actual');\n    }\n\n    //Restal Tab actual\n    const tab = document.querySelector(`[data-paso=\"${pagina}\"]`);\n    tab.classList.add('actual');\n\n}\n\nfunction cambiarSeccion(){\n    const enlaces = document.querySelectorAll('.tabs button')\n    enlaces.forEach(enlace =>{\n        enlace.addEventListener('click', e =>{\n        pagina = parseInt(e.target.dataset.paso);\n\n        mostrarSeccion()\n        botonesPaginador()\n        })\n    })\n \n}\n\nasync function mostrarServicios(){\n    try {\n        const url = 'http://localhost:3000/servicios.php';\n        const resultado = await fetch(url);\n        const db = await resultado.json();\n        \n        //generar HTML\n        db.forEach(servicio => {\n            const {id, nombre, precio} = servicio; \n            \n            //DOM Scripting\n            //generar nomobre de servicio\n            const nombreServicio = document.createElement('P');\n            nombreServicio.textContent = nombre;\n            nombreServicio.classList.add('nombre-servicio')\n            \n\n            //generar precio\n            const precioServicio = document.createElement('P');\n            precioServicio.textContent = `$ ${precio}`;\n            precioServicio.classList.add('precio-servicio')\n\n            //generar div contenedor\n            const servicioDiv = document.createElement('DIV');\n            servicioDiv.classList.add('servicio');\n            servicioDiv.dataset.idServicio = id;\n            //inyectar un servicio para la cita\n            servicioDiv.onclick = selecionarServicio;\n\n\n            // inyectar servicio precio y nombre al div\n            servicioDiv.appendChild(nombreServicio);\n            servicioDiv.appendChild(precioServicio);\n            //inyectar en el html\n            document.querySelector('#servicios').appendChild(servicioDiv);\n        });\n\n    } catch (error) {\n        console.log(error);\n    }\n}\n\nfunction selecionarServicio(e){\n    let elemento;\n    //forzar que el elemento al cual le damos click sea el DIV\n    if (e.target.tagName === 'P'){\n        elemento = e.target.parentElement;\n    }else{\n        elemento = e.target;\n    }\n\n    if(elemento.classList.contains('seleccionado')){\n        elemento.classList.remove('seleccionado');\n\n        const id = parseInt(elemento.dataset.idServicio);\n        eliminarServicio(id);\n    }else{\n        elemento.classList.add('seleccionado');\n       \n            const servicioObj = {\n                id: parseInt(elemento.dataset.idServicio),\n                nombre: elemento.firstElementChild.textContent,\n                precio: elemento.firstElementChild.nextElementSibling.textContent\n        }\n        \n        agregarServicio(servicioObj);\n\n    }\n}\n\nfunction eliminarServicio(id){\n    const {servicios} = cita;\n    cita.servicios = servicios.filter(servicio => servicio.id !== id);\n\n}\nfunction agregarServicio(servicioObj){\n    const {servicios} = cita;\n    cita.servicios = [...servicios, servicioObj];//3 puntos copia\n}\n\nfunction paginaSiguiente(){\n    const paginaSiguiente = document.querySelector('#siguiente');\n    paginaSiguiente.addEventListener('click', () =>{\n        pagina++;\n        botonesPaginador();\n    } )\n}\n\nfunction paginaAnterior(){\n    const paginaAnterior = document.querySelector('#anterior');\n    paginaAnterior.addEventListener('click', ()=>{\n        pagina--;\n\n      \n        botonesPaginador();\n    })\n}\n\nfunction botonesPaginador(){\n    const paginaSiguiente = document.querySelector('#siguiente');\n    const paginaAnterior = document.querySelector('#anterior');\n\n    if(pagina === 1){\n        paginaAnterior.classList.add('ocultar');\n        paginaSiguiente.classList.remove('ocultar');\n    }else if(pagina === 3){\n        paginaSiguiente.classList.add('ocultar');\n        paginaAnterior.classList.remove('ocultar');\n\n        mostrarResumen(); //estamos en la pagina 3, carga el resumen de la cita\n    }else{\n        paginaAnterior.classList.remove('ocultar')\n        paginaSiguiente.classList.remove('ocultar')\n    }\n    mostrarSeccion()\n}\n\nfunction mostrarResumen(){\n    //destructuring\n    \n        const {nombre, fecha, hora, servicios} = cita;\n\n        //selecciona el resumen\n        const resumenDiv = document.querySelector('.contenido-resumen');\n        //limpiar html previo\n       while(resumenDiv.firstChild){\n           resumenDiv.removeChild(resumenDiv.firstChild);\n       }\n\n        //validacion de objeto\n        if(Object.values(cita).includes('')){\n            const noServicios = document.createElement('P');\n            noServicios.textContent = 'Faltan Datos de Servicios, fecha hora o nombre';\n            noServicios.classList.add('invalidar-cita');\n\n            //agregar a resumenDiv\n            resumenDiv.appendChild(noServicios);\n            return;\n        }\n        const headingCita = document.createElement('H3');\n        headingCita.textContent = 'Resumen de Cita';\n      \n      \n\n        //mostrar el resumen\n        const nombreCita = document.createElement('P');\n        nombreCita.innerHTML = `<span>Nombre:</span> ${nombre}`;\n        const fechaCita = document.createElement('P');\n        fechaCita.innerHTML = `<span>Fecha:</span> ${fecha}`;\n        const horaCita = document.createElement('P');\n        horaCita.innerHTML = `<span>Hora:</span> ${hora}`; //inner = textcontent\n\n        const serviciosCita = document.createElement('DIV');\n        serviciosCita.classList.add('resumen-cita');\n\n        const headingServicios = document.createElement('H3');\n            headingServicios.textContent = 'Resumen de servicios';\n            serviciosCita.appendChild(headingServicios);\n\n        let cantidad = 0;\n        //iterar sobre el arreglo de servicios\n\n            servicios.forEach(servicio => {\n            const {nombre, precio} = servicio;\n\n            const contenedorServicio = document.createElement('DIV');\n            contenedorServicio.classList.add('contenedor-servicio');\n\n\n            const textoServicio = document.createElement('P');\n            textoServicio.textContent = nombre;\n\n            const precioServicio = document.createElement('P');\n            precioServicio.classList.add('precio');\n            precioServicio.textContent = precio;\n\n            const totalServicio = precio.split('$');\n            cantidad += parseInt( totalServicio[1].trim())\n            //colocar text y precio en el div\n\n            contenedorServicio.appendChild(textoServicio);\n            contenedorServicio.appendChild(precioServicio);\n            serviciosCita.appendChild(contenedorServicio);\n        });\n\n        resumenDiv.appendChild(headingCita);\n        resumenDiv.appendChild(nombreCita);\n        resumenDiv.appendChild(fechaCita);\n        resumenDiv.appendChild(horaCita);\n       \n        resumenDiv.appendChild(serviciosCita);\n\n        const cantidadPagar = document.createElement('P');\n        cantidadPagar.classList.add('total');\n        cantidadPagar.innerHTML = `<span>Total a Pagar: </span>  $${cantidad}`;\n        resumenDiv.appendChild(cantidadPagar);\n}\n\nfunction nombreCita(){\n    const nombreInput = document.querySelector('#nombre');\n    nombreInput.addEventListener('input', e =>{\n        const nombreTexto = e.target.value.trim(); //lee los caracteres y corta los espacions *trim*\n        \n        //validacion de nombre texto\n        if(nombreTexto === '' || nombreTexto.length <= 2){\n            mostrarAlerta('Nombre no valido', 'error');\n        }else{\n            const alerta = document.querySelector('.alerta');\n            if(alerta){\n                alerta.remove();\n            }\n            cita.nombre = nombreTexto;\n        }\n    });\n}\nfunction mostrarAlerta(mensaje, tipo){\n    // si hay  una alerta no duplicarla\n   const alertaPrevia = document.querySelector('.alerta');\n   if(alertaPrevia){\n       return;\n   }\n\n    const alerta = document.createElement('DIV');\n    alerta.textContent= mensaje;\n    alerta.classList.add('alerta');\n\n    if(tipo === 'error'){\n        alerta.classList.add('error');\n    }\n\n    //insertar en el html\n    const formulario = document.querySelector('.formulario');\n    formulario.appendChild(alerta);\n\n    //eleminar la alerta despues de 3 segundos\n\n    setTimeout(() => {\n        alerta.remove();\n    }, 3000);\n}\n\nfunction fechaCita(){\n    const fechaInput = document.querySelector('#fecha');\n    fechaInput.addEventListener('input', e =>{\n\n        const dia = new Date(e.target.value).getUTCDay();\n    \n        if([0].includes(dia)){\n            e.preventDefault();\n            fechaInput.value = '';\n            mostrarAlerta('dia cerrado', 'error')\n        }else{\n            cita.fecha = fechaInput.value;\n        }\n         \n    })\n}\n\nfunction deshabilitarFechaAnterior(){\n    const fechaInput = document.querySelector('#fecha');   \n\n    const fechaAhora = new Date();\n    let year = fechaAhora.getFullYear();\n    let mes = fechaAhora.getMonth() +1;\n    let dia = fechaAhora.getDate() + 1;\n      \n     //formato deseado 2021-02-22 (AAAA-MM-DD)\n     const fechaDeshabilitar = `${year}-${mes < 10 ? `0${mes}` : mes}-${dia < 10 ? `0${dia}` : dia}`\n   \n     fechaInput.min = fechaDeshabilitar;\n   \n}\n\nfunction horaCita(){\n    const inputHora = document.querySelector('#hora');\n    inputHora.addEventListener('input', e =>{\n        const horaCita = e.target.value;\n        const hora = horaCita.split(':')\n        if(hora[0] < 10 || hora[0] > 18){\n            mostrarAlerta('hora no valida', 'error');\n            setTimeout(() => {\n                inputHora.value = '';\n            }, 3000);\n            \n        }else{\n            cita.hora = horaCita;\n        }\n    \n    })\n   \n}\n"]}